{
  "commands": [
    "export HOME=/root",
    "cd /var/www/summit/server",
    "echo '=== Ensuring server is running ==='",
    "pm2 stop summit 2>/dev/null; pm2 delete summit 2>/dev/null; true",
    "echo ''",
    "echo 'Starting server...'",
    "PORT=3000 NODE_ENV=production pm2 start dist/index.js --name summit --update-env",
    "pm2 save",
    "sleep 8",
    "echo ''",
    "pm2 list",
    "echo ''",
    "pm2 logs summit --lines 10 --nostream 2>&1",
    "echo ''",
    "curl -s http://localhost:3000/health || echo 'HEALTH_CHECK_FAILED'",
    "echo ''",
    "ss -tlnp | grep :3000 || echo 'PORT_NOT_LISTENING'"
  ]
}

