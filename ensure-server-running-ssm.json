{
  "commands": [
    "cd /var/www/summit/server",
    "export HOME=/root",
    "export PATH=$PATH:/usr/bin:/usr/local/bin",
    "echo '=== Checking if server is running ==='",
    "pm2 list | grep summit && echo 'Server is running' || echo 'Server is NOT running'",
    "echo ''",
    "echo '=== Starting/Restarting Server ==='",
    "pm2 stop summit 2>/dev/null; pm2 delete summit 2>/dev/null; true",
    "cd /var/www/summit/server",
    "NODE_ENV=production PORT=3000 pm2 start dist/index.js --name summit",
    "pm2 save",
    "sleep 5",
    "echo ''",
    "echo '=== PM2 Status ==='",
    "pm2 list",
    "echo ''",
    "echo '=== Testing Port 3000 ==='",
    "curl -s -o /dev/null -w '%{http_code}' http://localhost:3000/health && echo ' - Health check OK' || echo 'Health check failed'",
    "echo ''",
    "echo '=== Port Status ==='",
    "ss -tlnp | grep :3000 || netstat -tlnp | grep :3000 || echo 'Port 3000 not found'"
  ]
}

