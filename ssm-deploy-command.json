{
  "commands": [
    "#!/bin/bash",
    "set -e",
    "cd /tmp",
    "rm -rf summit",
    "git clone https://github.com/Icokruger999/summit.git",
    "cd summit/backend",
    "mkdir -p /var/www/summit",
    "cp -r dist package.json package-lock.json .env.production /var/www/summit/",
    "cd /var/www/summit",
    "if command -v npm >/dev/null 2>&1; then npm install --production; fi",
    "JWT_SECRET=$(openssl rand -base64 32)",
    "sed \"s/CHANGE_ON_DEPLOYMENT/$JWT_SECRET/\" .env.production > .env",
    "if command -v pm2 >/dev/null 2>&1; then pm2 stop summit-backend 2>/dev/null || true; pm2 delete summit-backend 2>/dev/null || true; pm2 start dist/index.js --name summit-backend; pm2 save; fi",
    "echo 'Deployment complete!'",
    "curl http://localhost:4000/health || echo 'Backend not started yet - Node.js/PM2 installation may still be in progress'"
  ]
}

