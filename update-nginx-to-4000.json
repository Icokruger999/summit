{
  "commands": [
    "cd /etc/nginx",
    "sudo find . -type f -name '*.conf' -exec grep -l 'api.codingeverest.com' {} \\; 2>/dev/null || echo 'Finding config files...'",
    "sudo sed -i.bak 's|proxy_pass http://127.0.0.1:5001|proxy_pass http://127.0.0.1:4000|g' /etc/nginx/conf.d/*.conf 2>/dev/null || echo 'Updating conf.d files...'",
    "sudo sed -i.bak 's|proxy_pass http://localhost:5001|proxy_pass http://localhost:4000|g' /etc/nginx/conf.d/*.conf 2>/dev/null || echo 'Updating localhost refs...'",
    "grep -r 'proxy_pass.*4000' /etc/nginx/conf.d/ 2>/dev/null | head -3 || echo 'Verifying 4000 references...'",
    "grep -r 'proxy_pass.*5001' /etc/nginx/conf.d/ 2>/dev/null | grep -v '5000' | head -3 || echo 'Checking for remaining 5001 refs (should be none)...'",
    "sudo nginx -t && sudo systemctl reload nginx && echo '✅ Nginx reloaded successfully' || echo '❌ Nginx reload failed'"
  ]
}

