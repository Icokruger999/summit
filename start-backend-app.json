{
  "InstanceIds": ["i-0fba58db502cc8d39"],
  "DocumentName": "AWS-RunShellScript",
  "Parameters": {
    "commands": [
      "cd /var/www/summit/server",
      "echo '=== Checking PM2 Status ==='",
      "pm2 list",
      "echo ''",
      "echo '=== Starting Backend ==='",
      "pm2 start dist/index.js --name summit-backend --update-env || pm2 restart summit-backend --update-env",
      "sleep 5",
      "echo '=== PM2 Status After Start ==='",
      "pm2 list",
      "echo ''",
      "echo '=== Testing Health ==='",
      "curl -s http://localhost:3000/health && echo ' - OK' || echo ' - FAILED'",
      "echo ''",
      "echo '=== Recent Logs ==='",
      "pm2 logs summit-backend --lines 5 --nostream 2>&1 | tail -5"
    ]
  }
}

